# VEGA-Verified Configuration for RISC-V Target
# ==============================================

# Target Information
target:
  name: "RISCV"
  triple: "riscv64-unknown-linux-gnu"
  description: "RISC-V 64-bit target backend"
  
  # Supported extensions
  extensions:
    - RV64I      # Base integer
    - RV64M      # Multiplication
    - RV64A      # Atomic
    - RV64F      # Single-precision FP
    - RV64D      # Double-precision FP
    - RV64C      # Compressed

# Reference Backends for Specification Inference
references:
  ARM:
    path: "llvm/lib/Target/ARM"
    modules:
      - ARMMCCodeEmitter
      - ARMAsmPrinter
      - ARMELFObjectWriter
  
  MIPS:
    path: "llvm/lib/Target/Mips"
    modules:
      - MipsMCCodeEmitter
      - MipsAsmPrinter
      - MipsELFObjectWriter
  
  AArch64:
    path: "llvm/lib/Target/AArch64"
    modules:
      - AArch64MCCodeEmitter
      - AArch64AsmPrinter

# Module Configurations
modules:
  MCCodeEmitter:
    # Functions to verify
    functions:
      - name: "encodeInstruction"
        priority: 10
        critical: true
      - name: "getMachineOpValue"
        priority: 9
      - name: "getMemoryOpValue"
        priority: 8
      - name: "getBranchTargetOpValue"
        priority: 7
      - name: "getImmOpValue"
        priority: 6
    
    # Expected verification targets
    expected_accuracy: 0.85
    
  AsmPrinter:
    functions:
      - name: "emitInstruction"
        priority: 10
        critical: true
      - name: "printOperand"
        priority: 8
      - name: "printMemOperand"
        priority: 7
      - name: "printBranchOperand"
        priority: 6
    
    expected_accuracy: 0.80
    
  ELFObjectWriter:
    functions:
      - name: "getRelocType"
        priority: 10
        critical: true
      - name: "needsRelocateWithSymbol"
        priority: 8
      - name: "writeNopData"
        priority: 5
    
    expected_accuracy: 0.90

# Interface Contracts
interface_contracts:
  MCCodeEmitter:
    assumptions:
      - name: "valid_instruction"
        condition: "(and (>= opcode 0) (< opcode 1024))"
        description: "Opcode is within RISC-V instruction range"
      
      - name: "valid_operands"
        condition: "(forall ((i Int)) (=> (< i num_ops) (valid_riscv_operand (op i))))"
        description: "All operands are valid RISC-V operands"
    
    guarantees:
      - name: "correct_encoding_size"
        condition: "(or (= size 4) (and compressed (= size 2)))"
        description: "Encoding is 4 bytes (or 2 for compressed)"
      
      - name: "decodable"
        condition: "(= (decode (encode inst)) inst)"
        description: "Encoded instruction can be decoded back"
  
  ELFObjectWriter:
    assumptions:
      - name: "valid_fixup"
        condition: "(member fixup_kind RISCV_FIXUP_KINDS)"
        description: "Fixup kind is valid for RISC-V"
    
    guarantees:
      - name: "correct_reloc"
        condition: "(member result RISCV_RELOC_TYPES)"
        description: "Result is a valid RISC-V relocation type"

# Verification Overrides (specific to RISC-V)
verification:
  # RISC-V-specific timeout (may need more time due to extensions)
  timeout_ms: 45000
  
  # BMC bound for RISC-V instruction patterns
  bmc:
    max_bound: 15

# Repair Overrides
repair:
  # RISC-V-specific repair patterns
  additional_patterns:
    - name: "riscv_compressed_fallback"
      pattern: "if (!isCompressed(MI)) return encodeRVC(MI);"
      replacement: "return encodeStandard(MI);"
    
    - name: "riscv_reloc_mapping"
      pattern: "case FK_Data_4: return ELF::R_RISCV_32;"

# Expected Results (for evaluation)
expected_results:
  function_accuracy: 0.85
  semantic_correctness: 1.0
  verified_functions: 0.80
  generation_time_hours: 2.0
